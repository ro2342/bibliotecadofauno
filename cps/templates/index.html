{% import 'image.html' as image %}
{% extends "layout.html" %}
{% block body %}
{% if continue_reading and continue_reading|length > 0 %}
<section class="mb-16">
  <h2 class="font-display text-3xl mb-8 flex items-center gap-2">
    <span class="material-symbols-outlined text-[hsl(var(--md-sys-color-primary))]">play_circle</span>
    {{_('Continue Reading')}}
  </h2>
  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-8">
    {% for item in continue_reading %}
    <div class="group session transition-all duration-300 transform hover:-translate-y-2" id="books_continue">
      <div class="relative card-expressive overflow-hidden mb-4 shadow-lg group-hover:shadow-2xl transition-shadow">
          <a href="{{ url_for('web.read_book', book_id=item.book.id, book_format=item.format) }}" class="block aspect-[2/3]">
              {{ image.book_cover(item.book) }}
              <div class="absolute inset-x-0 bottom-0 h-1 bg-black/10">
                <div class="h-full transition-all duration-500" style="width: {{ item.progress_percent }}%; background-color: hsl(var(--md-sys-color-primary));"></div>
              </div>
              <span class="absolute top-2 right-2 bg-[hsl(var(--md-sys-color-primary))] text-white text-[10px] font-bold px-2 py-1 rounded-full shadow-md">{{ item.progress_percent }}%</span>
          </a>
      </div>
      <div class="text-center sm:text-left">
        <a href="{{ url_for('web.read_book', book_id=item.book.id, book_format=item.format) }}">
          <h3 title="{{item.book.title}}" class="font-display text-lg font-bold truncate leading-tight">{{item.book.title}}</h3>
        </a>
        <p class="text-xs text-neutral-500 truncate mt-1">
          {% for author in item.book.authors %}{{author.name.replace('|',',')}}{% if not loop.last %}, {% endif %}{% endfor %}
        </p>
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

{% if current_user.show_detail_random() and page != "discover" %}
<section class="mb-16">
  <h2 class="font-display text-3xl mb-8 flex items-center gap-2">
    <span class="material-symbols-outlined text-[hsl(var(--md-sys-color-primary))]">auto_awesome</span>
    {{_('Discover (Random Books)')}}
  </h2>
  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-8">
    {% for entry in random %}
    <div class="group session transition-all duration-300 transform hover:-translate-y-2" id="books_rand">
      <div class="relative card-expressive overflow-hidden mb-4 shadow-lg group-hover:shadow-2xl transition-shadow">
          <a href="{{ url_for('web.show_book', book_id=entry.Books.id) }}" class="block aspect-[2/3]" {% if simple==false %}data-toggle="modal" data-target="#bookDetailsModal" data-remote="false"{% endif %}>
              {{ image.book_cover(entry.Books) }}
              {% if entry[2] == True %}
                <div class="absolute top-2 right-2 bg-green-600 text-white p-1 rounded-full shadow-md flex items-center justify-center">
                  <span class="material-symbols-outlined !text-xs">check</span>
                </div>
              {% endif %}
          </a>
      </div>
      <div class="text-center sm:text-left">
        <a href="{{ url_for('web.show_book', book_id=entry.Books.id) }}" {% if simple==false %}data-toggle="modal" data-target="#bookDetailsModal" data-remote="false"{% endif %}>
          <h3 title="{{entry.Books.title}}" class="font-display text-lg font-bold truncate leading-tight">{{entry.Books.title}}</h3>
        </a>
        <p class="text-xs text-neutral-500 truncate mt-1">
          {% for author in entry.Books.authors %}{{author.name.replace('|',',')}}{% if not loop.last %}, {% endif %}{% endfor %}
        </p>
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<section>
  <div class="flex flex-col sm:flex-row justify-between items-end mb-8 gap-4">
    <h2 class="font-display text-4xl flex items-center gap-3">
        <span class="material-symbols-outlined text-[hsl(var(--md-sys-color-primary))] !text-4xl">library_books</span>
        {{title}}
    </h2>
    
    {% if page != 'discover' %}
    <div class="flex gap-2">
        <div class="bg-white/20 p-1 rounded-xl backdrop-blur-sm flex gap-1">
            <a title="{{_('Newest First')}}" class="p-2 rounded-lg transition-colors {% if order == 'new' %} bg-[hsl(var(--md-sys-color-primary))] text-white shadow-lg {% else %} hover:bg-white/20 {% endif %}" href="{{url_for('web.books_list', data=page, book_id=id, sort_param='new')}}"><span class="material-symbols-outlined !text-sm">calendar_month</span></a>
            <a title="{{_('Alphabetical')}}" class="p-2 rounded-lg transition-colors {% if order == 'abc' %} bg-[hsl(var(--md-sys-color-primary))] text-white shadow-lg {% else %} hover:bg-white/20 {% endif %}" href="{{url_for('web.books_list', data=page, book_id=id, sort_param='abc')}}"><span class="material-symbols-outlined !text-sm">sort_by_alpha</span></a>
        </div>
    </div>
    {% endif %}
  </div>

  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-8">
    {% if entries[0] %}
    {% for entry in entries %}
    <div class="group session transition-all duration-300 transform hover:-translate-y-2" id="books">
      <div class="relative card-expressive overflow-hidden mb-4 shadow-lg group-hover:shadow-2xl transition-shadow">
          <a href="{{ url_for('web.show_book', book_id=entry.Books.id) }}" class="block aspect-[2/3]" {% if simple==false %}data-toggle="modal" data-target="#bookDetailsModal" data-remote="false"{% endif %}>
            {{ image.book_cover(entry.Books) }}
            {% if entry[2] == True %}
              <div class="absolute top-2 right-2 bg-green-600 text-white p-1 rounded-full shadow-md">
                <span class="material-symbols-outlined !text-xs">check</span>
              </div>
            {% endif %}
          </a>
      </div>
      <div class="text-center sm:text-left">
        <a href="{{ url_for('web.show_book', book_id=entry.Books.id) }}" {% if simple==false %}data-toggle="modal" data-target="#bookDetailsModal" data-remote="false"{% endif %}>
          <h3 title="{{ entry.Books.title }}" class="font-display text-lg font-bold truncate leading-tight">{{entry.Books.title}}</h3>
        </a>
        <p class="text-xs text-neutral-500 truncate mt-1">
          {% for author in entry.Books.authors %}{{author.name.replace('|',',')}}{% if not loop.last %}, {% endif %}{% endfor %}
        </p>
      </div>
    </div>
    {% endfor %}
    {% endif %}
  </div>
</section>
{% endblock %}
